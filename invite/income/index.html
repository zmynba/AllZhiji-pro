<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=750,user-scalable=no">
		<title>邀请员收益明细</title>
		<meta name="keywords" content="BothLive">
		<meta name="description" content="BothLive">
		<link rel="stylesheet" href="../css/main.css?v20190816" />
		<link rel="stylesheet" href="../css/index.css?v20200721" />
		<style type="text/css">
			[v-cloak]{
				display: none;
            }
            input[type=search]::-webkit-search-cancel-button{
                -webkit-appearance: none;
            }
			.income-bg{
				background:#fff;
			}
			.head-part{
				display: flex;
				justify-content: space-between;
				align-items: center;
				height: 100px;
				background: #fff;
                padding: 0 25px;
                border-bottom: 1px solid #DFDFDF;
			}
			.head-part img{
				width: 40px;
			}
			.head-part span:nth-of-type(1){
				font-size: 30px;
			}
			.head-part span:nth-of-type(2){
				width: 40px;
            }
            
			.time-part{
				background: #fff;
				padding-left:25px;
			}
			.time-one{
				display: flex;
				flex-direction: row;
				justify-content: space-between;
				align-items: center;
				height: 110px;
				padding-right:25px;
				border-bottom: 1px solid #ddd;

			}
			.time-one span{
				font-size: 30px;
				color: #333;
			}
			.time-one span:nth-of-type(2){
                color: #B1B1B1;
                display: inline-flex;
                align-items: center;
                font-size:30px;
            }
            .time-one span:nth-of-type(2) img{
                margin-left: 26px;
            }
            .time-bottom{
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 0 15px;
                position: fixed;
                bottom: 40px;
            }
            .time-bottom-l{
                display: inline-flex;
                width: 360px;
                align-items: center;
            }
            .time-bottom-l span{
                width: 340px;
                height: 72px;
                border-radius: 100px;
                background: #EBEBEB;
                color: #4D4D4D;
                font-size: 24px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
            }
            .time-bottom-r{
                display: inline-flex;
                width: 360px;
                height: 110px;
                background: url(../img/time-s.png) no-repeat;
                justify-content: center;
                align-items: center;
                font-size: 24px;
                color: #fff;
            }

            .top-search{
                display: flex;
                width: 726px;
                margin: 12px auto;
                height: 80px;
                align-items: center;
                background: #F5F5F5;
                border-radius:6px;
                padding: 0 15px 0 24px;
                box-sizing: border-box;
            }
            .top-search img:nth-of-type(1){
                width: 30px;
                margin-right: 16px;
            }
            .top-search img:nth-of-type(2){
                width: 32px;
            }
            .top-search input{
                display: inline-flex;
                border: 0;
                width: 610px;
                height: 60px;
                color: #333;
                font-size: 28px;
                background:#F5F5F5;
            }
            .select-time-part{
                width:750px;
                height: 160px;
                background: url(../img/time-bk.png) no-repeat;
                background-size: 100% 100%;
                justify-content: space-between;
                padding: 0 39px 0 17px;
                flex-direction: row;
                display: flex;
                align-items: flex-end;
            }
            .select-time-l{
                display: inline-flex;
                flex-direction: row;
                justify-content: center;
                align-items: center;
                background: url(../img/time-w.png) no-repeat;
                width: 256px;
                height: 144px;
                margin-bottom: 7px;
            }
            .select-time-r{
                display: inline-flex;
                margin-bottom: 17px;
                color: #fff;
                font-size: 24px;
                align-items: flex-end;
                width: 350px;
            }
            .select-time-r b{
                font-size: 42px;
                margin-left: 10px;
                margin-bottom: -7px;
            }
            .select-time-r img{
                margin-left: 5px;
            }
            .select-time-l-l{
                display: inline-flex;
                flex-direction: column;
            }
            .select-time-l-l span{
                color: #333;
                font-size: 26px;
                padding: 10px 0;
            }
            .select-time-l img{
                margin-left: 20px;
            }
            .select-time-l-l span:nth-of-type(1){
                border-bottom: 1px  solid #D9D9D9;
            }




            .getaward-part{
                padding-left: 25px;
            }
            .getaward-one{
                display: flex;
                justify-content: space-between;
                align-items: center;
                height: 180px;
                padding-right: 25px;
                border-bottom: 1px solid #EBEBEB;
            }
            .getaward-one-l{
                display: inline-flex;
                flex-direction: column;
                width: 420px;
            }
            .getaward-one-r{
                display: inline-flex;
                flex-direction: column;
                align-items: flex-end;
            }
            .getaward-one-l span:nth-of-type(1){
                color: #333;
                font-size: 30px;  
                margin-bottom: 20px;
            }
            .getaward-one-l span:nth-of-type(2){
                color: #B1B1B1;
                font-size: 24px;  
                align-items: center;
            }
            .getaward-one-l span:nth-of-type(2) b{
                font-weight: normal;
                color: #F3511E;
                font-size: 24px;
            }
            .getaward-one-r span:nth-of-type(1){
                color: #F79F0A;
                font-size: 30px;  
                margin-bottom: 20px;
                display: inline-flex;
                align-items: baseline;
            }
            .getaward-one-r span:nth-of-type(2){
                color: #B1B1B1;
                font-size: 24px;  
            }
            .getaward-one-r span:nth-of-type(1) img{
                margin-left: 10px;
            }
            .nodata{
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                margin-top: 127px;
            }
            .nodata img{
                width: 256px;
            }
            .nodata span{
                color: #8B8B8B;
                font-size: 30px;
                margin-top: 40px;
            }
            .income-bg .loading_dp {
                width: 30px;
                height: 30px;
                margin-right: 10px;
            }
            .income-bg .refresh_text{
                font-size: 30px;
            }
            /* .sel-boxs .sel-box .name{
                color: #333;
            } */
		</style>
	</head>
	<body class="income-bg">
		<div id="income" v-cloak dir="auto">
            <!-- <div class="head-part">
                <img src="../img/back1.png" alt="" v-if="!timeshow">
                <img src="../img/back1.png" alt="" v-if="timeshow" @click="timeshow=false;">
                <span>{{interLang.invite_income_bills}}</span>
                <span></span>
            </div> -->
            <!-- 收益明细层 -->
            <div class="income-layer" v-show="!timeshow">
                <div class="top-search">
                    <img src="../img/icon_search.png" alt="">
                    <input v-bind:placeholder="interLang.invite_searchid" v-model="searchid" type="search" @keyup.13="tapToSearch" />
                    <img src="../img/c_20.png" @click="claerid" />
                </div>
                <div class="select-time-part">
                    <div class="select-time-l" @click="timeshow=true;">
                        <div class="select-time-l-l">
                            <span>{{sDate}}</span>
                            <span>{{eDate}}</span>
                        </div>
                        <img src="../img/san-jiao.png" alt="">
                    </div>
                    <div class="select-time-r">{{interLang.invite_charge_percent}}：<b>{{allmoney}}</b><img src="../img/b-big.png" /></div>
                </div>
                <div v-if="total>0">
                    <div class="getaward-part">
                        <div class="getaward-one" v-for="item in incomelist" @click="gopage(item)">
                            <div class="getaward-one-l">
                                <span>{{item.goods_type}}</span>
                                <span>{{interLang.invite_from}}<b>【{{item.nick}}】</b></span>
                            </div>
                            <div class="getaward-one-r">
                                <span>{{item.dollarself}}<img src="../img/b-small.png" /></span>
                                <span>{{item.addtime}}</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div v-else class="nodata">
                    <img src="../img/nodata.png" alt="">
                    <span>{{interLang.invite_no_record}}</span>
                </div>
            </div>
            <!--选择时间层-->
            <div class="time-layer" v-show="timeshow">
                <div class="time-part">
                    <div class="time-one" id="dateone">
                        <span>{{interLang.invite_starttime}}</span>
                        <span id="startDate">{{sDate}}<img src="../img/time-m.png"></span>
                    </div>
                    <div class="time-one" id="datetwo">
                        <span>{{interLang.invite_endtime}}</span>
                        <span id="endDate">{{eDate}}<img src="../img/time-m.png"></span>
                    </div>
                </div>

                <div class="time-bottom">
                    <div class="time-bottom-l" @click="settime">
                        <span>{{interLang.invite_reset}}</span>
                    </div>
                    <div class="time-bottom-r" v-on:click="surepost(null)">{{interLang.invite_sure}}</div>
                </div>
            </div>
		</div>
		
        <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
        <script>
			if (navigator.userAgent.match(/(iPhone|iPod|ios|iPad)/i)) {
				document.write("<script src='../../cordova_bothlive/cordova.js?sddssss'><\/script>");
			}
		</script>
        <script src="https://cdn.bootcss.com/vue/2.6.11/vue.min.js"></script>
        <script src="../js/jquery.selector.js"></script>
        <script src="../js/lang-zhu.js"></script>
        <script src="../js/lang.js?999"></script>
        <script src="../js/app.js"></script>
		<script>
			var vm=new Vue({
				el:'#income',
				data:{
                    interLang:interLang_P,
                    timeshow:false,

                    searchid:"",
                    starttime:"",
                    endtime:"",
                    incomelist:[],
                    allmoney:0,
                    total:0
                },
                created(){
                    this.settime();
                },
                computed:{
                    sDate(){
                        return this.starttime;
                    },
                    eDate(){
                        return this.endtime;
                    }
                },
				mounted(){
                    var that=this;
                    //获取开始日期
                    $.dateSelector({
                        title: that.interLang.invite_starttime,
                        defBg: '#f4521e',
                        evEle: '#dateone',
                        year: new Date().getFullYear() - 18,
                        startYear: '1990',
                        endYear: new Date().getFullYear(),
                        afterAction(res){
                            that.starttime=res.date;
                        }
                    })

                    $.dateSelector({
                        title: that.interLang.invite_endtime,
                        defBg: '#f4521e',
                        evEle: '#datetwo',
                        year: new Date().getFullYear() - 18,
                        startYear: '1990',
                        endYear: new Date().getFullYear(),
                        afterAction(res){
                            that.endtime=res.date;
                        }
                    })
                    this.surepost(null);



                    $('.income-layer').downRefreshDp({
                        //下拉刷新
                        downRefreshFn: function(me){
                            that.surepost(me)
                        }
                    })
                    document.title=this.interLang.invite_allget_detail;
				},
				methods:{
                    claerid(){
                        this.searchid="";
                    },
                    surepost(me){
                        var searchurl=location.search;
                        //searchurl='__adjustadid=26a913a65f66987f6559654b3df46096&__version=9.9.9.1653&__channel=googleplay&bl_token=c70ebf10e9ff6207fdad52ddf80d8dc6&__plat=android&__lg=zh&__gps_adid=eeb21488-dfae-4152-947a-375e4c87b081&bl_time=1595924680&__guid=ea232ec762a94e74a5ea8ea7d52de8b2&hostid=10006';
                        var pdata={
                            search_uid:this.searchid,
                            starttime:this.starttime,
                            endtime:this.endtime,
                            refund:0
                        };
                        var that=this;
						$.ajax({
                            type:'GET',
                            url:'http://m.api.bothlive.com/promote/payorderlist/'+searchurl,
                            data:pdata,
                            xhrFields: {
                                withCredentials: true
                            },
							success:function(res){
                                if(res.errno==0){
                                    //that.allinfo=res.data;
                                    if(res.data.total>0){
                                        for(var i=0;i<res.data.items.length;i++){
                                            res.data.items[i].addtime=app.formatDate(res.data.items[i].addtime*1000);
                                            res.data.items[i].paytime=app.formatDate(res.data.items[i].paytime*1000);
                                            if(res.data.items[i].goods_type=="gold"){
                                                res.data.items[i].goods_type=that.interLang.invite_reback_gold;
                                            }else if(res.data.items[i].goods_type=="vip"){
                                                res.data.items[i].goods_type=that.interLang.invite_vip_reward;
                                            }else if(res.data.items[i].goods_type=="svip"){
                                                res.data.items[i].goods_type=that.interLang.invite_svip_reward;
                                            }
                                        }
                                    }
                                    that.incomelist=res.data.items;
                                    that.allmoney=res.data.totalincome;
                                    that.total=res.data.total;
                                    that.timeshow=false;
                                }

                                if(me){
                                    me.resetLoad();
                                }
							}
						})
                    },
                    settime(){
                        var s_year,s_month,s_day;
                        var nowtime=new Date();
                        var year=nowtime.getFullYear();
                        var month=nowtime.getMonth() + 1;
                        var day=nowtime.getDate();
                        if(month>1){
                            s_year=year;
                            s_month=month-1;
                            s_day=day;
                        }else{
                            s_year=year-1;
                            s_month=12;
                            s_day=day;
                        }
                        if(s_month==2&&s_day>28){
                            s_day=28;
                        }
                        this.endtime=year+'-'+(month<10?('0'+month):month)+'-'+(day<10?('0'+day):day);
                        this.starttime=s_year+'-'+(s_month<10?('0'+s_month):s_month)+'-'+(s_day<10?('0'+s_day):s_day);
                    },
                    gopage(obj){
                        var strObj=encodeURI(JSON.stringify(obj));
                        location.href="http://wap.bothlive.com/apph5/invite/income/detail.html?detail="+strObj;
                    },
                    tapToSearch(){
                        this.surepost(null)
                    }
				}
            })
            
            if (navigator.userAgent.match(/(iPhone|iPod|ios|iPad)/i)) {
                function navBackClicked () {
                    goToBack(true);
                }
                function goToBack(toBack) {
                    //alert(41);
                    window.BothLive.closeWindow(null, null);
                }
            
                function enableBackHistory(enable) {
                    //alert(31);
                    window.BothLive.enableBackHistory(null, null, {"enable": enable});
                }
                function deviceready() {
                    enableBackHistory(true);
                }
                document.addEventListener('deviceready', deviceready, false); 
            }
		</script>
	</body>
</html>
